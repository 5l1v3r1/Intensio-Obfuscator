# -*- coding: utf-8 -*-
import socket
import struct
from crypto import uUQBvWTVdHhaZCiRFpnwzeFprQxQMSHihQIcRATzMvcGRTosuOLrFBJFTKLIwVAbmMhijMAdaWUHRUdEKqPhzbgMlGAxGguCsswIialtFMEYhtyNfsApWJahohslhTVI
from crypto import feRprzYhmoVnfMLBUuwBDssJCQgoaHxoyDyenHFEtueLMpoVzKoElyzOvRRFbrUvbWOOZWVBkkdoTNNVJwzuYzhRvZNVLDNVPKgdMwaIYvZvHBqHhGkQurlJfrfGGSPF
def OTbChUrcVhkiWcCDWawwlAtEBBfdXyDUUlUkNZmWSbJZdFGpZggoFkGzDHxVRLxUNTnHjYxZClpPLPUGtJQuSgGsDILzKRYOhThlKGrAhEPzvtjyJDMHQeWrgHXCUVwF(sock, VIZhhPTBOMfeuuVDPmeEDDfpWpThWtpEYtLvDNyLveeTSSOcTOOVqqZcbbIblQzORxpUYmkiEWdNwPaWrUlYZrgoXDXHmZlohypDhwSSuTXIIFkzCbyXeVhhQUtoudRm, key):
    with open(VIZhhPTBOMfeuuVDPmeEDDfpWpThWtpEYtLvDNyLveeTSSOcTOOVqqZcbbIblQzORxpUYmkiEWdNwPaWrUlYZrgoXDXHmZlohypDhwSSuTXIIFkzCbyXeVhhQUtoudRm, 'wb') as f:
        EgCfbXXaqOLBUvfVBnwwQOkxsHvsUqKRqqUrgQvVOoiLZyLbLoIdkmMmLqXHulCgAOSoCwJJWFpCsTNxGeaIOBurcjbjVwIYftdnWxeVexgRAsXuVoKdDxivilqorfGZ = struct.unpack("!I", sock.recv(4))[0]
        while EgCfbXXaqOLBUvfVBnwwQOkxsHvsUqKRqqUrgQvVOoiLZyLbLoIdkmMmLqXHulCgAOSoCwJJWFpCsTNxGeaIOBurcjbjVwIYftdnWxeVexgRAsXuVoKdDxivilqorfGZ:
            qJGzilgoktPWANZiQpMwMDSJLlHqxvoavtmehRsmERJMiJenlvFAjPscgFKXMtDFGgZsZagbSDZsEGMzbZqUHczhDqTaMBuTxIJvOphCZVzYAWPEvLmzjtminjvlRRUB = sock.recv(EgCfbXXaqOLBUvfVBnwwQOkxsHvsUqKRqqUrgQvVOoiLZyLbLoIdkmMmLqXHulCgAOSoCwJJWFpCsTNxGeaIOBurcjbjVwIYftdnWxeVexgRAsXuVoKdDxivilqorfGZ)
            f.write(feRprzYhmoVnfMLBUuwBDssJCQgoaHxoyDyenHFEtueLMpoVzKoElyzOvRRFbrUvbWOOZWVBkkdoTNNVJwzuYzhRvZNVLDNVPKgdMwaIYvZvHBqHhGkQurlJfrfGGSPF(qJGzilgoktPWANZiQpMwMDSJLlHqxvoavtmehRsmERJMiJenlvFAjPscgFKXMtDFGgZsZagbSDZsEGMzbZqUHczhDqTaMBuTxIJvOphCZVzYAWPEvLmzjtminjvlRRUB, key))
            EgCfbXXaqOLBUvfVBnwwQOkxsHvsUqKRqqUrgQvVOoiLZyLbLoIdkmMmLqXHulCgAOSoCwJJWFpCsTNxGeaIOBurcjbjVwIYftdnWxeVexgRAsXuVoKdDxivilqorfGZ = struct.unpack("!I", sock.recv(4))[0]
def gJkxicaYvuWUgfCenItuqmZMcMtrcRAdGMXkhffCGxXhjvOUWdVYFdHxMlFWbJOgyOhBBvDIKeffKrCyxVBzLvTSoSGzTYUSiRxdWcyhltBpIlOwgPLPXcASpXxsaKAK(sock, VIZhhPTBOMfeuuVDPmeEDDfpWpThWtpEYtLvDNyLveeTSSOcTOOVqqZcbbIblQzORxpUYmkiEWdNwPaWrUlYZrgoXDXHmZlohypDhwSSuTXIIFkzCbyXeVhhQUtoudRm, key):
    with open(VIZhhPTBOMfeuuVDPmeEDDfpWpThWtpEYtLvDNyLveeTSSOcTOOVqqZcbbIblQzORxpUYmkiEWdNwPaWrUlYZrgoXDXHmZlohypDhwSSuTXIIFkzCbyXeVhhQUtoudRm, 'rb') as f:
        qJGzilgoktPWANZiQpMwMDSJLlHqxvoavtmehRsmERJMiJenlvFAjPscgFKXMtDFGgZsZagbSDZsEGMzbZqUHczhDqTaMBuTxIJvOphCZVzYAWPEvLmzjtminjvlRRUB = f.read(4096)
        while len(qJGzilgoktPWANZiQpMwMDSJLlHqxvoavtmehRsmERJMiJenlvFAjPscgFKXMtDFGgZsZagbSDZsEGMzbZqUHczhDqTaMBuTxIJvOphCZVzYAWPEvLmzjtminjvlRRUB):
            JurHVeYXwzzjFYiovVtzNYnooBjiHBCNYXxUaCQEDMnrtrWdGRgLrHFxTryeKLnhFNVRFYTpmJctXjNMSyGrRmvIbAGZxJBaezKLFaNOEwlpldPdFcLHdWgrUajRwtqm = uUQBvWTVdHhaZCiRFpnwzeFprQxQMSHihQIcRATzMvcGRTosuOLrFBJFTKLIwVAbmMhijMAdaWUHRUdEKqPhzbgMlGAxGguCsswIialtFMEYhtyNfsApWJahohslhTVI(qJGzilgoktPWANZiQpMwMDSJLlHqxvoavtmehRsmERJMiJenlvFAjPscgFKXMtDFGgZsZagbSDZsEGMzbZqUHczhDqTaMBuTxIJvOphCZVzYAWPEvLmzjtminjvlRRUB, key)
            sock.send(struct.pack("!I", len(JurHVeYXwzzjFYiovVtzNYnooBjiHBCNYXxUaCQEDMnrtrWdGRgLrHFxTryeKLnhFNVRFYTpmJctXjNMSyGrRmvIbAGZxJBaezKLFaNOEwlpldPdFcLHdWgrUajRwtqm)))
            sock.send(JurHVeYXwzzjFYiovVtzNYnooBjiHBCNYXxUaCQEDMnrtrWdGRgLrHFxTryeKLnhFNVRFYTpmJctXjNMSyGrRmvIbAGZxJBaezKLFaNOEwlpldPdFcLHdWgrUajRwtqm)
            qJGzilgoktPWANZiQpMwMDSJLlHqxvoavtmehRsmERJMiJenlvFAjPscgFKXMtDFGgZsZagbSDZsEGMzbZqUHczhDqTaMBuTxIJvOphCZVzYAWPEvLmzjtminjvlRRUB = f.read(4096)
        sock.send('\x00\x00\x00\x00')
